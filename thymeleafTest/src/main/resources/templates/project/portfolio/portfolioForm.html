<!DOCTYPE html>
<html 	xmlns = "http://www.w3.org/1999/xhtml"
		xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>Akame - PORTFOLIO</title>

    <!-- Favicon -->
    <link rel="icon" href="../../static/images/core-img/favicon.ico">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="../../static/style.css">
    <link rel="stylesheet" href="../../static/css/join.css">
    <link rel="stylesheet" href="../../static/css/subHeader.css">
    
   <style>
   
	button{
		border:0;
		outline:0;
		background-color:white;
		cursor:pointer;
	}
   </style>
   
<script src="../../static/js/file_common.js"></script>
<script src="//code.jquery.com/jquery-3.3.1.min.js"></script>    
<script th:inline="javascript">
	$(document).ready(function(){
		
		listFile();
	});
	
	/* <![CDATA[ */   
	
	function listFile(){
		var html = "";
    	var list = [[${list}]]; 
    	console.log(list);
    	if(list != null){
	    	var listSize = list.length;
	    	//alert(listSize);
	    	for(var i = 0;i<listSize; i++){
	    		html = "";
	           // 파일정보 가공
	           var file_no = list[i].file_no;
	           console.log("file_no->"+file_no);
	           var fileInfo = getFileInfo(list[i].files);
	           console.log("------->"+fileInfo.fullname);
	       	// 이미지 파일일 경우
	           if (fileInfo.fullname.substr(12, 2) == "s_") {
	           	
	           	//$.each(fileInfo, function(index, value){
	                   html += "<span class="+"\"mailbox-attachment-icon has-img\"><a href=\""+fileInfo.getLink+"\" class=\"mailbox-attachment-name\" data-lightbox=\"uploadImages\">"
	                   		+ "<img src=\""+fileInfo.imgsrc+"\" width=\"200\" alt=\"Attachment\" >"
		            		+	"</span>";
	               //});
	           // 이미지 파일이 아닐 경우
	           } else {
	               html = "";
	           }
	        	console.log("#"+file_no+"uploadedList");
	           $("#"+file_no+"uploadedList").append(html);
	    	}  
	    }
	}
	
	function addLove(portfolio_no){
		//console.log("portfolio_no->"+portfolio_no);
		var good_msg = "좋아요 기능은 회원만 사용가능합니다.";
	
		$.ajax({
			type: "post",
			url: "/project/portfolio/portfolioAddGood",
			data: {"portfolio_no" : portfolio_no},		
			dataType: "text",
			success: function(result){
				if(result == "true"){
					console.log("좋아요!");
				}
				else{
					alert(good_msg);
					window.location.href = "/project/member/loginForm";
				}
			}
		});
	}
	 /*]]>*/
</script>
</head>

<body>
<!-- th:onclick="'javascript:listFile('+ ${list.files} + ');'" -->
<div th:include="include/subHeader" ></div>
	<!-- 내용 추가 -->
	<form id="portfolioFrm" enctype="multipart/form-data">
		<h3 style="text-align:center;margin-top:3%;">PORTFOLIO</h3>
		
		<div style="overflow-x:auto;">
		<table id="table-re">
			<tr>
				<td>PICTURE</td>
				<td>DESIGNER</td>
				<td>POSITION</td>
				<!-- <td>♡LOVE♡</td> -->
			</tr>
			<tr th:if="${list != null}" th:each="list : ${list}">
		<!-- 	<input type = "hidden" th:onclick="listFile([[${list.files}]]);" /> -->
				<td th:value = "${list.file_no}">
				<div><ul th:attr="id=|${list.file_no}uploadedList|"></ul><button th:onclick="'javascript:addLove(\''+ ${list.portfolio_no} +'\');'">♡</button>
				<span th:text="${list.portfolio_good_cnt}"></span>
				</div></td>
				<td th:value="${list.emp_no}" th:text="${list.emp_name}"></td>
				<td th:value="${list.emp_grade_cd}" th:text="${list.emp_grade_nm}"></td>
				<!-- <td th:text="${list.portfolio_good_cnt}"></td> -->
			</tr>
			<tr th:if = "${list == null}">
				<td colspan = "3" style = "text-align:center;">현재 게시된 portfolio는 없습니다. </td> 
			</tr>
		</table>
		</div>
	</form>		 
	
<div th:include="include/subFooter" ></div>
</body>

</html>